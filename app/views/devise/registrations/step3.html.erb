<div class="sign-up-header" style="min-width: 100%; height: 50px; text-align: center;">
  <p class="create-account-text" style="color: #FFA01C; font-family: 'Roboto', sans-serif; font-weight: bold; font-size: 40px; margin: 0;">Cr√©ez votre compte</p>
</div>

<div class="sign-up-header" style="min-width: 100%; display: flex; justify-content: center; padding-top: 30px; padding-bottom: 30px">
  <%= image_tag('progress-bar-sign-up-3.png', alt: 'progress bar step 3/4', class: 'centered-image', style: "width: 457px") %>
</div>

<div class="sign-up-step-container" style="min-width: 100%; height: 86vh; display: flex">

  <div class="sign-up-left" style="min-width: 50%; display: flex; justify-content: center; flex-direction: column">

    <div style="text-align: center; height: 150px">
      <p class="create-account-text" style="color: #FFA01C; font-family: 'Roboto', sans-serif; font-weight: bold; font-size: 32px; margin: 0; width: 460px; margin: auto">Simple CRM simplifie la vie des organisations, quel que soit leur statut, activit√©e ou localisation</p>
    </div>
    <div class="sign-up-header" style="display: flex; justify-content: center; padding-top: 30px">
      <%= image_tag('undraw_work-friends_kto3.svg', alt: 'work with friends', class: 'centered-image', style: "width: 457px") %>
    </div>
  </div>

  <div class="sign-up-right" style="min-width: 50%; padding-top: 30px">
   <%= form_for @user, as: :user, url: step4_users_registrations_path, method: :post do |f| %>
      <%= render 'devise/shared/error_messages', resource: @user %>

      <%= f.fields_for :organisation do |org_form| %>
        <div class="form-group-sub">
          <%= org_form.label :country, class: 'sub-custom-label' %>
          <%= org_form.select :country, [['üá´üá∑ France', 'France'], ['üáµüáπ Portugal', 'Portugal'], ['üáßüá∑ Brazil', 'Brazil']], { include_blank: 'Pays' }, class: 'sub-custom-input country-select' %>
        </div>

        <div class="form-group-sub" id="status-field" style="display: none;">
          <%= org_form.label :status, class: 'sub-custom-label' %>
          <%= org_form.select :status, [
                ['Entreprise Individuelle (EI)', 'Entreprise Individuelle'],
                ['Auto-entrepreneur', 'Auto-entrepreneur'],
                ['Soci√©t√© √† Responsabilit√© Limit√©e (SARL)', 'SARL'],
                ['Entreprise Unipersonnelle √† Responsabilit√© Limit√©e (EURL)', 'EURL'],
                ['Soci√©t√© par Actions Simplifi√©e (SAS)', 'SAS'],
                ['Soci√©t√© par Actions Simplifi√©e Unipersonnelle (SASU)', 'SASU'],
                ['Soci√©t√© Anonyme (SA)', 'SA'],
                ['Soci√©t√© en Nom Collectif (SNC)', 'SNC'],
                ['Soci√©t√© Civile (SC)', 'SC'],
                ['Soci√©t√© en Commandite Simple (SCS)', 'SCS'],
                ['Association avec numeros de siret', 'ASSO-SIRET'],
                ['Association sans numeros de siret', 'ASSO-WITHOUT-SIRET']
            ], { include_blank: 'Statut juridique' }, class: 'sub-custom-input' %>
        </div>

        <div class="form-group-sub">
          <%= org_form.label :name, class: 'sub-custom-label' %>
          <%= text_field_tag :organisation_search, '', placeholder: 'Rechercher votre entreprise...', class: 'sub-custom-input', id: 'organisation-search', data: { controller: "autocomplete" } %>
        </div>

        <div class="form-group-sub" id="identification-field" style="display: none;">
          <%= org_form.label :identification_number, class: 'sub-custom-label' %>
          <%= org_form.text_field :identification_number, class: 'sub-custom-input' %>
        </div>

        <div class="form-group-sub" id="vat-field" style="display: none;">
          <%= org_form.label :vat_number, class: 'sub-custom-label' %>
          <%= org_form.text_field :vat_number, class: 'sub-custom-input' %>
        </div>
      <% end %>

      <div class="form-group-sub", style="display: none;">
        <%= f.submit "Suivant", class: 'sub-custom-button' %>
      </div>

      <div id="country-message" style="display: none; color: red;"></div>
    <% end %>
  </div>

</div>

<script>
// document.addEventListener('DOMContentLoaded', function() {
//   const countrySelect = document.querySelector('.country-select');
//   const statusField = document.getElementById('status-field');
//   const identificationField = document.getElementById('identification-field');
//   const vatField = document.getElementById('vat-field');
//   const countryMessage = document.getElementById('country-message');

//   countrySelect.addEventListener('change', function() {
//     const selectedCountry = countrySelect.value;

//     if (selectedCountry === 'France') {
//         console.log("France selected")
//       statusField.style.display = 'block';
//       identificationField.style.display = 'block';
//       vatField.style.display = 'block';
//       countryMessage.style.display = 'none';
//     } else {
//       statusField.style.display = 'none';
//       identificationField.style.display = 'none';
//       vatField.style.display = 'none';
//       countryMessage.style.display = 'block';
//       countryMessage.textContent = "Nous sommes d√©sol√©s, mais Simple CRM n'est pas encore disponible pour ce pays.";
//     }
//   });
// });

document.addEventListener('DOMContentLoaded', function() {
  const countrySelect = document.querySelector('.country-select');
  const statusSelect = document.querySelector('select[name="organisation[status]"]');
  const searchField = document.getElementById('organisation-search');
  const identificationField = document.getElementById('identification-field');
  const vatField = document.getElementById('vat-field');
  const countryMessage = document.getElementById('country-message');

  // Montrer ou cacher les champs en fonction du pays
  countrySelect.addEventListener('change', function() {
    const selectedCountry = countrySelect.value;

    if (selectedCountry === 'France') {
      console.log("France selected");
      statusSelect.closest('.form-group-sub').style.display = 'block';
      countryMessage.style.display = 'none';
    } else {
      statusSelect.closest('.form-group-sub').style.display = 'none';
      searchField.closest('.form-group-sub').style.display = 'none';
      identificationField.style.display = 'none';
      vatField.style.display = 'none';
      countryMessage.style.display = 'block';
      countryMessage.textContent = "Nous sommes d√©sol√©s, mais Simple CRM n'est pas encore disponible pour ce pays.";
    }
  });

  // G√©rer l'affichage du champ de recherche bas√© sur le statut
  statusSelect.addEventListener('change', function() {
    const selectedStatus = statusSelect.value;
    
    // Montrer le champ de recherche seulement si ce n'est pas une association sans SIRET
    if (selectedStatus !== 'ASSO-WITHOUT-SIRET') {
      searchField.closest('.form-group-sub').style.display = 'block';
    } else {
      searchField.closest('.form-group-sub').style.display = 'none';
      identificationField.style.display = 'none';
      vatField.style.display = 'none';
    }
  });

  // Simuler le remplissage automatique apr√®s s√©lection (pour illustration)
  searchField.addEventListener('change', function() {
    // Suppose qu'une entreprise a √©t√© s√©lectionn√©e
    const organisationSelected = searchField.value;
    if (organisationSelected) {
      identificationField.style.display = 'block';
      vatField.style.display = 'block';
      // Il faudrait aussi remplir les champs de donn√©es ici si besoin
    }
  });


</script>





